<html xmlns="http://www.w3.org/1999/xhtml"> 
    <head> 
        <title>XAPI Query Builder</title> 
        <link rel="stylesheet" href="http://openlayers.org/dev/theme/default/style.css" type="text/css" /> 
        <link rel="stylesheet" href="style.css" type="text/css" /> 
        <script src="http://openlayers.org/dev/OpenLayers.js"></script> 
        <script type="text/javascript"> 
            var lon = 5;
            var lat = 40;
            var zoom = 5;
            var map, layer;
 
            function init(){
                map = new OpenLayers.Map('map');
                layer = new OpenLayers.Layer.OSM( "Mapnik" );
 
                var control = new OpenLayers.Control();
                OpenLayers.Util.extend(control, {
                    draw: function () {
                        // this Handler.Box will intercept the shift-mousedown
                        // before Control.MouseDefault gets to see it
                        this.box = new OpenLayers.Handler.Box( control,
                            {"done": this.notice},
                            {keyMask: OpenLayers.Handler.MOD_SHIFT});
                        this.box.activate();
                    },
 
                    notice: function (bounds) {
                        var ll = map.getLonLatFromPixel(new OpenLayers.Pixel(bounds.left, bounds.bottom)); 
                        var ur = map.getLonLatFromPixel(new OpenLayers.Pixel(bounds.right, bounds.top)); 
                        var llLat = ll.transform(map.getProjectionObject(), new OpenLayers.Projection("EPSG:4326"));
                        var urLat = ur.transform(map.getProjectionObject(), new OpenLayers.Projection("EPSG:4326"));
                        alert(llLat.lon.toFixed(4) + ", " + 
                              llLat.lat.toFixed(4) + ", " + 
                              urLat.lon.toFixed(4) + ", " + 
                              urLat.lat.toFixed(4));
                    }
                });
 
                map.addLayer(layer);
                map.addControl(control);
                map.setCenter(new OpenLayers.LonLat(lon, lat), zoom);
            }
        </script> 
    </head> 
    <body onload="init()"> 
        <h1 id="title">Custom Control Example</h1> 
 
        <div id="tags"> 
            control, panel, rectangle
        </div> 
 
        <p id="shortdesc"> 
            Demonstrate the addition of a rectangle to the OpenLayers window.
        </p> 
      
        <div id="map" class="smallmap"></div> 
 
        <div id="docs"> 
            The control allows you to draw a rectangle, that reports its coordinates
            after creation. Hold down the shift key on your keyboard and draw a 
            rectangle with the mouse.
        </div> 
    </body> 
</html> 
